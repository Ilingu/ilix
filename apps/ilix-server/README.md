maybe do middleware for some endpoints check of kp and device_id
